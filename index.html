<!DOCTYPE html>
<html>
<head>
  <title>Wordle Cheater v03</title>
<!--   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/> -->
  <meta name="viewport" content="user-scalable=no"/>
<style>


:root {
  --green: #49BE25;
  --gold: #D5C450; 
  /*--grey: #A0A0A0;*/
  --white: #fffff1;
  --grey:#C9C9C9;
  --blue: #0040FF;
  --lighttan: #F6E3CE;
  --midtan: #F5D0A9;
  --lightblue:#A9D0F5;
  --midblue: #5882FA;
  --lightmagenta:#F6CEF5;
  --verylightmagenta:#F8E0F7;
  --halfheight:30px;
  --height: 50px;
  --height_0:50px;
  --width1: 100%;
  --width2: 94%;
  --text_font:50px;
  --button_font:25px;
  --option_font:25px;
}

body {
  height: 100%;
  height: 100vh;  
}

h2 {
  font-style: italic;
}

.black {
  color:#000000;
}
.green {
  background-color: var(--green);
  color: var(--green);
}
.gold {
  background-color: var(--gold);
  color: var(--gold);
}
.grey {
  background-color: var(--grey);
  color: var(--grey);
}
.white {
  background-color: var(--white);  
}
.lighttan {
  background-color: var(--lighttan);
}
.midtan {
  background-color: var(--midtan);
}

.option{
  text-align: center;  
  font-size: var(--option_font);
}

#title {
  grid-area: ti;
  color:blue;
  text-align: center;  
  font-size: var(--text_font);
}

#selectdate {
  grid-area:sd;
  text-align: center;  
  font-size: var(--button_font);  
}
#solutions {
  grid-area:sl;
  text-align: center;  
  font-size: var(--button_font);
}

#enterword {
  grid-area: en;
  font-size: var(--button_font);
}

#wordinput {
  grid-area: wi;
  font-size: var(--button_font);
  resize: none;
  initial-scale:1;
  maximum-scale:1;
  user-scalable:0;
}

#t1 {
  grid-area:t1;
}

#t2 {
  grid-area:t2;
}
#t3 {
  grid-area:t3;
}
#t4 {
  grid-area:t4;
}
#t5 {
  grid-area:t5;
}

#b11 {
  grid-area:b11;
}
#b12 {
  grid-area:b12;
}
#b13 {
  grid-area:b13;
}

#b21 {
  grid-area:b21;
}
#b22 {
  grid-area:b22;
}
#b23 {
  grid-area:b23;
}

#b31 {
  grid-area:b31;
}
#b32 {
  grid-area:b32;
}
#b33 {
  grid-area:b33;
}

#b41 {
  grid-area:b41;
}
#b42 {
  grid-area:b42;
}
#b43 {
  grid-area:b43;
}

#b51 {
  grid-area:b51;
}
#b52 {
  grid-area:b52;
}
#b53 {
  grid-area:b53;
}

#addword {
  grid-area:ai;
  font-size: var(--text_font)
}

#w11 {
  grid-area: w11;
}
#w12 {
  grid-area: w12;
}
#w13 {
  grid-area: w13;
}
#w14 {
  grid-area: w14;
}
#w15 {
  grid-area: w15;
}

#w21 {
  grid-area: w21;
}
#w22 {
  grid-area: w22;
}
#w23 {
  grid-area: w23;
}
#w24 {
  grid-area: w24;
}
#w25 {
  grid-area: w25;
}

#w31 {
  grid-area: w31;
}
#w32 {
  grid-area: w32;
}
#w33 {
  grid-area: w33;
}
#w34 {
  grid-area: w34;
}
#w35 {
  grid-area: w35;
}

#w41 {
  grid-area: w41;
}
#w42 {
  grid-area: w42;
}
#w43 {
  grid-area: w43;
}
#w44 {
  grid-area: w44;
}
#w45 {
  grid-area: w45;
}

#w51 {
  grid-area: w51;
}
#w52 {
  grid-area: w52;
}
#w53 {
  grid-area: w53;
}
#w54 {
  grid-area: w54;
}
#w55 {
  grid-area: w55;
}

#findwords {
  grid-area:fw;
}

#json_results {
  grid-area:df;
}

.bord {
  text-align: center;
  border: 1px solid rgba(0, 0, 0, 0.8);
}

.container {
  display:grid;
  grid-template-columns:repeat(10,1fr);
/*  grid-template-rows: 2.5fr 1.5fr 1fr 1fr 1.5fr 1fr 1fr 1fr 1.5fr;*/
  grid-template-rows: 0.7fr 0.25fr 0.25fr 0.25fr 0.25fr 0.25fr 0.5fr;
  font-size: var(--text_font);
  font-weight: bold;
  grid-template-areas: 
    "ti ti ti ti ti ti ti ti ti ti"
    "en en en en en w11 w12 w13 w14 w15"    
    "en en en en en w21 w22 w23 w24 w25"    
    "wi wi wi wi wi w31 w32 w33 w34 w35"
    "sd sd sd sd sd w41 w42 w43 w44 w45"
    "sl sl sl sl sl w51 w52 w53 w54 w55"
    "ai ai ai ai ai ai ai ai ai ai"
/*
    "ti ti ti ti ti ti ti ti ti ti ti ti ti ti ti"
    "sd sd sd sd sd sd sd sd sd sd w11 w12 w13 w14 w15"
    "sl sl sl sl sl sl sl sl sl sl w21 w22 w23 w24 w25"
    "sl sl sl sl sl sl sl sl sl sl w31 w32 w33 w34 w35"
    "en en en en en en en en en en w41 w42 w43 w44 w45"
    "wi wi wi wi wi wi wi wi wi wi w51 w52 w53 w54 w55"
    "b11 b12 b13 b21 b22 b23 b31 b32 b33 b41 b42 b43 b51 b52 b53"
    ". . .   .   .   w11 w12 w13 w14 w15   .   . . . ."
    ". . .   .   .   w21 w22 w23 w24 w25   .   . . . ."
    ". . .   .   .   w31 w32 w33 w34 w35   .   . . . ."
    ". . .   .   .   w41 w42 w43 w44 w45   .   . . . ."
    ". . .   .   .   w51 w52 w53 w54 w55   .   . . . ."
/*    "ai ai ai ai ai ai ai ai ai ai ai ai ai ai ai"
    ". . w11 w12 w13 w14 w15 . w21 w22 w23 w24 w25 . ."
    ". . w31 w32 w33 w34 w35 . w41 w42 w43 w44 w45 . ."
    ". . .   .   .   w51 w52 w53 w54 w55   .   . . . ."*/;
  grid-gap:2px;
  height:60vh;
  width:90vw;
  margin:auto;
/*  padding-left: 20px;
  padding-right: 20px;*/
}

.container2 {
  width:70vw;
  margin:auto;
  margin-top:50px;
/*  padding-left: 20px;
  padding-right: 20px;*/
}

button {
  text-align: center;
  align-content: center;
  height:100%;
  width: 100%;
  font-size: var(--button_font);
  font-weight: bold;
}

.curved {
  background-color: var(--lighttan);
  border-radius: 70px;  
}

table.dataTable td {
  font-size: 1.6em;
}
table.dataTable tr.dtrg-level-0 td {
  font-size: 1.8em;
}


</style>


</head>
<body>
<div class="container">
    <button class="bord black" id="title">Wordle Cheater</button>
    
    <button class="bord black" id="enterword">Enter Initial Words Below:</button>
    <input id="wordinput" class="bord black" onClick="textToButton()" type="text"></input>
    
    <button class="bord black" id="selectdate">Select A Date:</button>
    <select class="bord black" name="cars" id="solutions">
    </select>
    
    <button id="w11" size=1 type="text" class="bord"></button>
    <button id="w12" size=1 type="text" class="bord"></button>
    <button id="w13" size=1 type="text" class="bord"></button>
    <button id="w14" size=1 type="text" class="bord"></button>
    <button id="w15" size=1 type="text" class="bord"></button>

    <button id="w21" size=1 type="text" class="bord"></button>
    <button id="w22" size=1 type="text" class="bord"></button>
    <button id="w23" size=1 type="text" class="bord"></button>
    <button id="w24" size=1 type="text" class="bord"></button>
    <button id="w25" size=1 type="text" class="bord"></button>

    <button id="w31" size=1 type="text" class="bord"></button>
    <button id="w32" size=1 type="text" class="bord"></button>
    <button id="w33" size=1 type="text" class="bord"></button>
    <button id="w34" size=1 type="text" class="bord"></button>
    <button id="w35" size=1 type="text" class="bord"></button>

    <button id="w41" size=1 type="text" class="bord"></button>
    <button id="w42" size=1 type="text" class="bord"></button>
    <button id="w43" size=1 type="text" class="bord"></button>
    <button id="w44" size=1 type="text" class="bord"></button>
    <button id="w45" size=1 type="text" class="bord"></button>

    <button id="w51" size=1 type="text" class="bord"></button>
    <button id="w52" size=1 type="text" class="bord"></button>
    <button id="w53" size=1 type="text" class="bord"></button>
    <button id="w54" size=1 type="text" class="bord"></button>
    <button id="w55" size=1 type="text" class="bord"></button>

    <button id="addword" type="button" class="bord curved" onClick="add_words()">Find Possible Words</button>
</div>

<p></p>
<div id="wordsused"></div>
<p></p>
<div class="container2">
    <h2 id="json_title_0"></h2>
    <table class="bord" id="json_results_0"></table>
</div>  

<p></p>
<div class="container2">
    <h2 id="json_title_1"></h2>
    <table class="bord" id="json_results_1"></table>
</div>

<p></p>
<div class="container2">
    <h2 id="json_title_2"></h2>
    <table class="bord" id="json_results_2"></table>
</div>

<p></p>
<div class="container2">
    <h2 id="json_title_3"></h2>
    <table class="bord" id="json_results_3"></table>
</div>

<p></p>
<div class="container2">
    <h2 id="json_title_4"></h2>
    <table class="bord" id="json_results_4"></table>
</div>


<!--  ************ Scripts below ************** -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.css">
  
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.js"></script>

<script> 
var words = [];
var words_choices = [];
var green = "#49BE25";
var gold = "#D5C450"; 
var grey = "#C9C9C9" // "#A0A0A0" #D8D8D8
var black = "#000000";
var white = "#fffff9";

var color_arr = [green, gold, grey]

var default_initial_words = "alert,noisy";
// var fetch_url = "http://127.0.0.1:8000/wordl/solve";
// var dates_url = "http://127.0.0.1:8000/wordl/solutions";
var fetch_url = "https://c732-13-57-204-106.ngrok.io/wordl/solve";
var dates_url = "https://c732-13-57-204-106.ngrok.io/wordl/solutions";



function reset_all(reset_words=1) {
  if (reset_words==1){
    words = [];
    words_choices = [];
    for (var i=0;i<5;i++){
      reset_saved_word(i);
    }
  for (i=0;i<5;i++) {
    var tbn = 'json_results_' + i;
    document.getElementById(tbn).innerHTML = "";
  }
  };
  if (document.getElementById("wordinput").value.length <1) {
    document.getElementById("wordinput").value = default_initial_words;
  }

  add_options();
};

function add_options(){
  fetch(dates_url, 
  {
      method: 'GET',
      headers: {
          'Accept': 'application/json',
      },
  })
  // .then(response => response.text())
  .then(
    function(response) {
      var r = response.text();
      return r;
    }
  )
  .then(text => JSON.parse(text))
  .then(function(json_results){
    var select = document.getElementById('solutions');
    for (i=0;i<json_results.length;i++){
      json_result = json_results[i];
      // Add an option
      let option = document.createElement('option');
      option.value = json_result['solution'];
      option.text = json_result['date'];
      select.add(option);      
    };
  })

}

function textToButton() {
  // var x = document.getElementById("wordinput").value;
  // x = x.trim();
  // for (let i = 0; i < 5; i++) {
  //   var v = i+1;
  //   v = "t" + v.toString();
  //   document.getElementById(v).innerHTML = ".";
  // };  
  // xlen = Math.min(x.length,5);
  // for (let i = 0; i < xlen; i++) {
  //   var v = i+1;
  //   v = "t" + v.toString();
  //   document.getElementById(v).innerHTML = x[i].toUpperCase();
  //   document.getElementById(v).style.color = black;
  // }; 
  
  
};


function rgb_to_hex(rgb_object) {
  rgb_string = rgb_object.toString();
  rgb = rgb_string.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);

  function hexCode(i) {
    return ("0" + parseInt(i).toString(16)).slice(-2);
  }
  var hex_value = "#" + hexCode(rgb[1]) + hexCode(rgb[2]) 
          + hexCode(rgb[3]);
  hex_value = hex_value.toUpperCase();
  return hex_value;
  }

function onbt1(clicked_id) {
  var t_id = clicked_id[1];
  var letter_id = Number(clicked_id[2])
  var color_sub = letter_id-1;
  var color = color_arr[color_sub];
  document.getElementById("t"+t_id).style.backgroundColor = color;
}

function reset_saved_word(word_index){
  var idx1 = word_index + 1;
  for (k=0;k<5;k++){
    var idx2 = k+1;
    var letter_element = document.getElementById("w"+idx1+idx2);
    letter_element.innerHTML = ".";
    letter_element.style.backgroundColor = white;
    letter_element.style.color = white;
  }
}

function display_word(word,word_index,letter_status){
  var idx1 = word_index + 1;
  for (i=0;i<5;i++){
    var idx2 = i+1;
    var letter_element = document.getElementById("w"+idx1+idx2);
    letter_element.innerHTML = word[i];
    var color_index = Number(letter_status[i])-1;
    letter_element.style.backgroundColor = color_arr[color_index];
    letter_element.style.color = black;
  }
}

function add_words(){
  try_it();
};


function try_it(){
  var words_element = document.getElementById("wordinput");
  var initialwords = words_element.value.toLowerCase()
  var solution = document.getElementById("solutions").value.toLowerCase();
  if (initialwords.length > 0) {
    full_url = fetch_url + "?initialwords=" + initialwords + "&solution=" + solution;
  } else {
    full_url = fetch_url + "solution=" + solution;
  }
  fetch(full_url, 
  {
      method: 'GET',
      headers: {
          'Accept': 'application/json',
      },
  })
  .then(
    function(response) {
      var r = response.text();
      // console.log(r);
      return r;
    }
  )
  .then(text => JSON.parse(text))
  .then(function(json_results){
    var words_used = json_results['wordsused'];
    var letter_status_used = json_results['letterstatusused'];
    
    // for (i=0;i<words_used.length;i++){
    for (var i=0;i<5;i++){
      var tbn = 'json_results_' + i;
      if (i>=words_used.length){
        document.getElementById("json_title_"+i).innerHTML = "";
        document.getElementById(tbn).innerHTML = "";
        reset_saved_word(i);
      } else {
        // add this word used to the title of the DataTable
        document.getElementById("json_title_"+i).innerHTML = "Possible words after using the word: " + words_used[i].toUpperCase();
        // add this word to the Wordle letter display
        display_word(words_used[i],i,letter_status_used[i]);
        // display the DataTable of possible next words for this word used
        var df = json_results[words_used[i]];
        if ( ! $.fn.DataTable.isDataTable("#" + tbn) ) {
          $("#" + tbn).dataTable( {
              "data": df,
              "columns":[
                {"data":"word","title":"word"},
                {"data":"probability","title":"probability"}
              ],
              order: [[1, 'desc']],
              "pageLength": 25,
          } );      
        } else {
          var dt = $("#" + tbn).dataTable();
          dt.fnClearTable();
          dt.fnAddData(df,redraw=true);
        }      
      }
    };
  })

}

// 
window.onload = reset_all();

</script>


</body>
</html>

